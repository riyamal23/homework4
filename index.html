<!DOCTYPE html>
<!--
Program name: patient-form.html
Author: Riya Malhotra
Date created: Oct 19, 2024
Date last edited: Dec 04, 2024
Version: 1.0
Description: This file contains the patient registration form for Precision Care Medical.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Patient Registration</title>
    <link href="./styles.css" rel="stylesheet">
</head>

<body>
    <header class="fixed-header">
    <div class="banner">
        <h1 id="headerTitle">Precision Care Medical</h1>
        <img src="../../Precision_Care.png" alt="Company Logo">
        <p>Today is: <span id="currentDate"></span></p>
    </div>
    <div id="dynamicCheckboxContainer" style="margin-top: 10px;"></div>
</header>

    <!-- iFrame Section (Embedding external content) -->
    <section id="iframeSection" style="margin: 20px 0;">
        <h2>Explore Health Resources</h2>
        <p>Before you submit your registration, take a moment to explore some valuable health resources:</p>
        <iframe src="https://www.cdc.gov" width="100%" height="500px" title="CDC Health Information"></iframe>
        <p>This is an embedded external website (CDC Health Resources) in an iframe. You can explore more by interacting with this embedded content.</p>
    </section>

    <!-- Main Form Section -->
    <main>
        <h2>Patient Registration Form</h2>
        <form id="registrationForm" onsubmit="handleFormSubmit(event)">
            <table>
                <tr>
                    <td><label for="first_name">First Name:</label></td>
                    <td><input type="text" id="first_name" name="first_name" maxlength="30" required></td>
                    <td><label for="middle_initial">Middle Initial:</label></td>
                    <td><input type="text" id="middle_initial" name="middle_initial" maxlength="1"></td>
                    <td><label for="last_name">Last Name:</label></td>
                    <td><input type="text" id="last_name" name="last_name" maxlength="30" required></td>
                </tr>
                <tr>
                    <td><label for="dob">Date of Birth (MM/DD/YYYY):</label></td>
                    <td><input type="text" id="dob" name="dob" placeholder="MM/DD/YYYY" required></td>
                </tr>
                <tr>
                    <td><label for="ssn">SSN:</label></td>
                    <td><input type="text" id="ssn" name="ssn" pattern="\d{3}-\d{2}-\d{4}" required></td>
                </tr>
                <tr>
                    <td><label for="address">Address Line 1:</label></td>
                    <td><input type="text" id="address" name="address" required></td>
                </tr>
                <tr>
                    <td><label for="address2">Address Line 2:</label></td>
                    <td><input type="text" id="address2" name="address2"></td>
                </tr>
                <tr>
                    <td><label for="city">City:</label></td>
                    <td><input type="text" id="city" name="city" maxlength="30" required></td>
                    <td><label for="state">State:</label></td>
                    <td>
                        <select id="state" name="state" required>
                            <option value="">Select State</option>
                            <option value="TX">Texas</option>
                            <option value="CA">California</option>
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD">Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>
                    </td>
                    <td><label for="zip">Zip Code:</label></td>
                    <td><input type="text" id="zip" name="zip" maxlength="10" required></td>
                </tr>
                <tr>
                    <td><label for="email">Email:</label></td>
                    <td><input type="email" id="email" name="email" required></td>
                </tr>
                <tr>
                    <td><label for="phone">Phone:</label></td>
                    <td><input type="tel" id="phone" name="phone" pattern="\d{3}-\d{3}-\d{4}"></td>
                </tr>
                <tr>
                    <td><label for="symptoms">Current Symptoms:</label></td>
                    <td colspan="5"><textarea id="symptoms" name="symptoms" rows="3" cols="50"></textarea></td>
                </tr>
                <tr>
                    <td colspan="6">Check all that apply:</td>
                </tr>
                <tr>
                    <td colspan="6">
                        <input type="checkbox" name="illnesses" value="Chicken Pox"> Chicken Pox
                        <input type="checkbox" name="illnesses" value="Measles"> Measles
                        <input type="checkbox" name="illnesses" value="Covid-19"> Covid-19
                        <input type="checkbox" name="illnesses" value="Small Pox"> Small Pox
                        <input type="checkbox" name="illnesses" value="Tetanus"> Tetanus
                    </td>
                </tr>
                <tr>
                    <td>Have you traveled internationally in the last 6 months?</td>
                    <td><input type="radio" name="travel" value="Yes" required> Yes</td>
                    <td><input type="radio" name="travel" value="No"> No</td>
                </tr>
                <tr>
                    <td>Have you been vaccinated?</td>
                    <td><input type="radio" name="vaccinated" value="Yes" required> Yes</td>
                    <td><input type="radio" name="vaccinated" value="No"> No</td>
                </tr>
                <tr>
                    <td>Are you currently taking any medications?</td>
                    <td><input type="radio" name="medications" value="Yes" required> Yes</td>
                    <td><input type="radio" name="medications" value="No"> No</td>
                </tr>
                <tr>
                    <td>Gender:</td>
                    <td><input type="radio" name="gender" value="Male" required> Male</td>
                    <td><input type="radio" name="gender" value="Female"> Female</td>
                    <td><input type="radio" name="gender" value="Other"> Other</td>
                </tr>
                <tr>
                    <td>Health Rating (1-10):</td>
                    <td><input type="range" id="health_rating" name="health_rating" min="1" max="10"></td>
                </tr>
                <tr>
                    <td><label for="user_id">Desired User ID:</label></td>
                    <td><input type="text" id="user_id" name="user_id" maxlength="20" required></td>
                </tr>
                <tr>
                    <td><label for="password">Password:</label></td>
                    <td><input type="password" id="password" name="password" required></td>
                </tr>
                <tr>
                    <td><label for="confirmPassword">Confirm Password:</label></td>
                    <td><input type="password" id="confirmPassword" name="confirmPassword" required>
                        <span id="passwordMessage" class="error-message"></span>
                    </td>
                <tr>
                    <td colspan="2">
                        <label>
                            <input type="checkbox" id="rememberMe" checked> Remember Me
                        </label>
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="text-align: center;">
                        <button type="submit">Submit</button>
                        <button type="reset">Clear and Start Over</button>
                        <button id="reviewButton" type="button">Review</button>
                    </td>
                </tr>
            </table>
        </form>
        <div id="reviewSection" style="margin-top: 20px;"></div>
    </main>

    <!-- Footer Section -->
<footer>
    </script>
    <div class="footer-content">
        <p>Precision Care Medical</p>
        <p>PO BOX 18881, Sugar Land, TX 77496</p>
        <button onclick="alert('Contact us at: contact@precisioncaremedical.com')">Contact Us</button>
        <div class="social-links">
            <a href="https://facebook.com" target="_blank">Facebook</a> | 
            <a href="https://twitter.com" target="_blank">Twitter</a> | 
            <a href="https://instagram.com" target="_blank">Instagram</a>
        </div>
        <img src="../../Precision_Care.png" alt="Company Logo" width="100">
    </div>
</footer>

<script>
        // Function to display the current date in the header
        function displayDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'short', day: 'numeric' };
            const today = new Date().toLocaleDateString('en-US', options);
            const dateElement = document.getElementById('currentDate');
            if (dateElement) {
                dateElement.innerHTML = today;
            }
        }

        // Function to set a cookie with an expiry of 48 hours
        function setCookie(name, value, hours) {
            const date = new Date();
            date.setTime(date.getTime() + (hours * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = `${name}=${value};${expires};path=/;`;
            console.log(`Cookie set: ${name}=${value}`);
        }

        // Function to get a cookie by name
        function getCookie(name) {
            const nameEQ = name + "=";
            const decodedCookie = decodeURIComponent(document.cookie);
            const cookieArray = decodedCookie.split(';');
            for (let i = 0; i < cookieArray.length; i++) {
                let cookie = cookieArray[i].trim();
                if (cookie.indexOf(nameEQ) === 0) {
                    return cookie.substring(nameEQ.length);
                }
            }
            return null;
        }

        // Function to delete a cookie
        function deleteCookie(name) {
            document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
            console.log(`Cookie deleted: ${name}`);
        }

        // Function to handle greeting based on cookie
        function handleGreeting() {
            const savedFirstName = getCookie('firstName');
            const headerTitle = document.getElementById('headerTitle');
            const dynamicCheckboxContainer = document.getElementById('dynamicCheckboxContainer');

            if (!headerTitle) {
                console.error("Header title element not found!");
                return; // If the element is not found, exit the function to prevent further errors
            }

            if (savedFirstName) {
                // Set personalized greeting if savedFirstName exists
                headerTitle.textContent = `Welcome back, ${savedFirstName}! Precision Care Medical`;

                // If the dynamic checkbox container exists, add the checkbox
                if (dynamicCheckboxContainer) {
                    dynamicCheckboxContainer.innerHTML = '';  // Clear previous content if any

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = 'newUserCheckbox';
                    checkbox.onclick = clearUserData;

                    const label = document.createElement('label');
                    label.htmlFor = 'newUserCheckbox';
                    label.textContent = `Not ${savedFirstName}? Click here to start as a new user.`;

                    dynamicCheckboxContainer.appendChild(checkbox);
                    dynamicCheckboxContainer.appendChild(label);
                } else {
                    console.error("Dynamic checkbox container not found!");
                }
            } else {
                // Set default greeting if no savedFirstName exists
                headerTitle.textContent = "Welcome New User! Precision Care Medical";
            }
        }

        // Function to clear user data and delete the cookie
        function clearUserData() {
            const isChecked = document.getElementById('newUserCheckbox').checked;
            if (isChecked) {
                deleteCookie('firstName');
                // Optionally, clear the form by reloading the page or other actions
                window.location.reload();  // Reload the page to reflect changes
            }
        }

        // Function to store the first name in a cookie when form is submitted
        function handleFormSubmit(event) {
            event.preventDefault();  // Prevent default submission
            const firstName = document.getElementById('first_name').value.trim();
            if (firstName) {
                setCookie('firstName', firstName, 48);  // Set cookie for 48 hours
                console.log(`Cookie set for firstName: ${firstName}`);
            }
            window.location.href = 'thankyou.html';  // Redirect to thank you page
        }

        // Function to handle form review
        function displayReview() {
            const firstName = document.getElementById('first_name').value.trim();
            const middleInitial = document.getElementById('middle_initial').value.trim();
            const lastName = document.getElementById('last_name').value.trim();
            const dob = document.getElementById('dob').value.trim();
            const ssn = document.getElementById('ssn').value.trim();
            const address1 = document.getElementById('address').value.trim();
            const address2 = document.getElementById('address2').value.trim();
            const city = document.getElementById('city').value.trim();
            const state = document.getElementById('state').value;
            const zip = document.getElementById('zip').value.trim();
            const email = document.getElementById('email').value.trim();
            const symptoms = document.getElementById('symptoms').value.trim();
            const travel = document.querySelector('input[name="travel"]:checked');
            const vaccinated = document.querySelector('input[name="vaccinated"]:checked');
            const medications = document.querySelector('input[name="medications"]:checked');
            const gender = document.querySelector('input[name="gender"]:checked');

            if (!travel || !vaccinated || !medications || !gender) {
                alert("Please complete all required fields before reviewing.");
                return;
            }

            const healthRating = document.getElementById('health_rating').value;
            const userId = document.getElementById('user_id').value.trim();

            const reviewInfo = `
                <h3>Review Information:</h3>
                <p><strong>First Name:</strong> ${firstName}</p>
                <p><strong>Middle Initial:</strong> ${middleInitial}</p>
                <p><strong>Last Name:</strong> ${lastName}</p>
                <p><strong>Date of Birth:</strong> ${dob}</p>
                <p><strong>Social Security Number:</strong> ${ssn}</p>
                <p><strong>Address Line 1:</strong> ${address1}</p>
                <p><strong>Address Line 2:</strong> ${address2}</p>
                <p><strong>City:</strong> ${city}</p>
                <p><strong>State:</strong> ${state}</p>
                <p><strong>Zip Code:</strong> ${zip}</p>
                <p><strong>Email Address:</strong> ${email}</p>
                <p><strong>Current Symptoms:</strong> ${symptoms}</p>
                <p><strong>International Travel:</strong> ${travel.value}</p>
                <p><strong>Vaccinated:</strong> ${vaccinated.value}</p>
                <p><strong>Currently Taking Medications:</strong> ${medications.value}</p>
                <p><strong>Gender:</strong> ${gender.value}</p>
                <p><strong>Health Rating:</strong> ${healthRating}</p>
                <p><strong>Desired User ID:</strong> ${userId}</p>
            `;

            // Add the review information to the review section below the form
            const reviewSection = document.getElementById('reviewSection');
            if (reviewSection) {
                reviewSection.innerHTML = reviewInfo;
            } else {
                console.error("Review section element not found!");
            }
        }    
        // Function to load first name from the cookie and set it in the input field
        function loadFirstName() {
            const savedFirstName = getCookie('firstName');
            if (savedFirstName) {
                const firstNameInput = document.getElementById('first_name');
                if (firstNameInput) {
                    firstNameInput.value = savedFirstName; // Prefill the first name field
                }
            }
        }

        // Attach event listener when the page loads
        window.onload = function () {
            displayDate();  // Display the current date
            handleGreeting();  // Display greeting and dynamic checkbox if needed
            loadFirstName();  // Prefill the first name field if a cookie is available

            const registrationForm = document.getElementById('registrationForm');
            if (registrationForm) {
                registrationForm.addEventListener('submit', handleFormSubmit);
            }

            const reviewButton = document.getElementById('reviewButton');
            if (reviewButton) {
                reviewButton.addEventListener('click', displayReview);
            } else {
                console.error("Review button element not found!");
            }
        };
</script>
</head>
</body>
</html>
